Model: "sequential"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
conv2d (Conv2D)              (None, 148, 148, 32)      896       
_________________________________________________________________
max_pooling2d (MaxPooling2D) (None, 74, 74, 32)        0         
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 72, 72, 64)        18496     
_________________________________________________________________
max_pooling2d_1 (MaxPooling2 (None, 36, 36, 64)        0         
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 34, 34, 64)        36928     
_________________________________________________________________
max_pooling2d_2 (MaxPooling2 (None, 17, 17, 64)        0         
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 15, 15, 32)        18464     
_________________________________________________________________
max_pooling2d_3 (MaxPooling2 (None, 7, 7, 32)          0         
_________________________________________________________________
conv2d_4 (Conv2D)            (None, 5, 5, 32)          9248      
_________________________________________________________________
max_pooling2d_4 (MaxPooling2 (None, 2, 2, 32)          0         
_________________________________________________________________
flatten (Flatten)            (None, 128)               0         
_________________________________________________________________
dense (Dense)                (None, 512)               66048     
_________________________________________________________________
dropout (Dropout)            (None, 512)               0         
_________________________________________________________________
dense_1 (Dense)              (None, 4)                 2052      
=================================================================
Total params: 152,132
Trainable params: 152,132
Non-trainable params: 0
_________________________________________________________________
Found 500 images belonging to 4 classes.

 1/50 [..............................] - ETA: 23s - loss: 1.3600e-05 - acc: 1.0000
 2/50 [>.............................] - ETA: 15s - loss: 0.1001 - acc: 0.9750    
 3/50 [>.............................] - ETA: 12s - loss: 0.0668 - acc: 0.9833
 4/50 [=>............................] - ETA: 10s - loss: 0.0501 - acc: 0.9875
 5/50 [==>...........................] - ETA: 9s - loss: 0.0408 - acc: 0.9900 
 6/50 [==>...........................] - ETA: 8s - loss: 0.0755 - acc: 0.9833
 7/50 [===>..........................] - ETA: 7s - loss: 0.0648 - acc: 0.9857
 8/50 [===>..........................] - ETA: 7s - loss: 0.0567 - acc: 0.9875
 9/50 [====>.........................] - ETA: 7s - loss: 0.0505 - acc: 0.9889
10/50 [=====>........................] - ETA: 7s - loss: 0.0471 - acc: 0.9900
11/50 [=====>........................] - ETA: 6s - loss: 0.0433 - acc: 0.9909
12/50 [======>.......................] - ETA: 6s - loss: 0.0401 - acc: 0.9917
13/50 [======>.......................] - ETA: 6s - loss: 0.0370 - acc: 0.9923
14/50 [=======>......................] - ETA: 6s - loss: 0.0344 - acc: 0.9929
15/50 [========>.....................] - ETA: 6s - loss: 0.0322 - acc: 0.9933
16/50 [========>.....................] - ETA: 6s - loss: 0.0302 - acc: 0.9937
17/50 [=========>....................] - ETA: 5s - loss: 0.0284 - acc: 0.9941
18/50 [=========>....................] - ETA: 5s - loss: 0.0271 - acc: 0.9944
19/50 [==========>...................] - ETA: 5s - loss: 0.0299 - acc: 0.9921
20/50 [===========>..................] - ETA: 5s - loss: 0.0284 - acc: 0.9925
21/50 [===========>..................] - ETA: 5s - loss: 0.0270 - acc: 0.9929
22/50 [============>.................] - ETA: 5s - loss: 0.0278 - acc: 0.9909
23/50 [============>.................] - ETA: 5s - loss: 0.0276 - acc: 0.9913
24/50 [=============>................] - ETA: 6s - loss: 0.0264 - acc: 0.9917
25/50 [==============>...............] - ETA: 5s - loss: 0.0254 - acc: 0.9920WARNING:tensorflow:Your input ran out of data; interrupting training. Make sure that your dataset or generator can generate at least `steps_per_epoch * epochs` batches (in this case, 50 batches). You may need to use the repeat() function when building your dataset.

50/50 [==============================] - 6s 122ms/step - loss: 0.0254 - acc: 0.9920
test acc: 0.9919999837875366
['category0', 'category1', 'category2', 'category3']
[[ 31   1   0   0]
 [  0 315   0   1]
 [  0   1 103   1]
 [  0   0   0  47]]
              precision    recall  f1-score   support

   category0       1.00      0.97      0.98        32
   category1       0.99      1.00      1.00       316
   category2       1.00      0.98      0.99       105
   category3       0.96      1.00      0.98        47

    accuracy                           0.99       500
   macro avg       0.99      0.99      0.99       500
weighted avg       0.99      0.99      0.99       500
